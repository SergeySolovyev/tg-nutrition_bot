# ü§ñ Telegram Nutrition Bot

Telegram-–±–æ—Ç –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –Ω–æ—Ä–º—ã –≤–æ–¥—ã, –∫–∞–ª–æ—Ä–∏–π –∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä –†–∞—Å—á—ë—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –Ω–æ—Ä–º –≤–æ–¥—ã –∏ –∫–∞–ª–æ—Ä–∏–π
- üíß –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–¥—ã
- üçΩÔ∏è –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (OpenFoodFacts + –ë–ñ–£ + –ª–∏—á–Ω–∞—è –±–∞–∑–∞)
- üèÉ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —Å —Ä–∞—Å—á—ë—Ç–æ–º —Å–æ–∂–∂—ë–Ω–Ω—ã—Ö –∫–∞–ª–æ—Ä–∏–π
- üìà –ì—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ –≤–æ–¥–µ –∏ –∫–∞–ª–æ—Ä–∏—è–º
- üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∏ –Ω–∏–∑–∫–æ–∫–∞–ª–æ—Ä–∏–π–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- üîç –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏:
  - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –ë–ñ–£ (Atwater factors)
  - Robust –≤—ã–±–æ—Ä —á–µ—Ä–µ–∑ weighted median
  - Confidence score —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –≤—ã–±–æ—Ä–æ–º
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ä—Ü–∏–π (—à—Ç/–º–ª/–ø–æ—Ä—Ü–∏–∏)
  - –ü–æ–∏—Å–∫ –ø–æ —à—Ç—Ä–∏—Ö–∫–æ–¥—É

## üöÄ –ö–æ–º–∞–Ω–¥—ã

- `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
- `/help` ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞
- `/set_profile` ‚Äî –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å (–≤–µ—Å, —Ä–æ—Å—Ç, –≤–æ–∑—Ä–∞—Å—Ç, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –≥–æ—Ä–æ–¥, —Ü–µ–ª—å –∫–∞–ª–æ—Ä–∏–π)
- `/log_water <–º–ª>` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å –≤–æ–¥—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: `/log_water 250`)
- `/log_food <–ø—Ä–æ–¥—É–∫—Ç> [–∫–æ–ª-–≤–æ]` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å –µ–¥—É (–ø—Ä–∏–º–µ—Ä—ã: `/log_food –±–∞–Ω–∞–Ω 1—à—Ç`, `/log_food —Ä–∏—Å 150`, `/log_food –º–æ–ª–æ–∫–æ 250–º–ª`)
- `/add_food <–Ω–∞–∑–≤–∞–Ω–∏–µ> <–∫–∫–∞–ª/100–≥> [–≥—Ä–∞–º–º_–≤_1—à—Ç]` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç –≤ –ª–∏—á–Ω—É—é –±–∞–∑—É
- `/log_workout <—Ç–∏–ø> <–º–∏–Ω>` ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É (–ø—Ä–∏–º–µ—Ä: `/log_workout –±–µ–≥ 30`)
- `/check_progress` ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞ —Å–µ–≥–æ–¥–Ω—è
- `/plot [–¥–Ω–∏]` ‚Äî –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 14 –¥–Ω–µ–π)
- `/reset_today` ‚Äî –æ–±–Ω—É–ª–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ –ª–æ–≥–∏

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **aiogram 3.x** ‚Äî —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram –±–æ—Ç–æ–≤
- **OpenFoodFacts API** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- **OpenWeatherMap / Open-Meteo** ‚Äî –ø–æ–≥–æ–¥–∞
- **matplotlib** ‚Äî –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- **Python 3.10+**

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω–æ

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/SergeySolovyev/tg-nutrition_bot.git
cd tg-nutrition_bot
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `env.example`:
```bash
cp env.example .env
```

4. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` –∏ —É–∫–∞–∂–∏—Ç–µ `BOT_TOKEN` (–ø–æ–ª—É—á–∏—Ç–µ —É @BotFather –≤ Telegram)

5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
```bash
python bot.py
```

### Docker

```bash
docker build -t nutrition-bot .
docker run --rm --env-file .env nutrition-bot
```

## üåê –î–µ–ø–ª–æ–π –Ω–∞ Render.com

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫ Render.com
2. –°–æ–∑–¥–∞–π—Ç–µ Web Service —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:
   - **Build Command**: (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Dockerfile)
   - **Start Command**: `python bot.py`
   - **Environment**: Python 3
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   - `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
   - `DATA_PATH` ‚Äî –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `data.json`)
   - `OPENWEATHER_API_KEY` ‚Äî –∫–ª—é—á OpenWeatherMap (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: —Å–º. `DEPLOY_INSTRUCTIONS.md`

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ bot.py              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ handlers.py         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ FSM
‚îú‚îÄ‚îÄ middlewares.py      # Middleware –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ calc.py            # –†–∞—Å—á—ë—Ç—ã (–≤–æ–¥–∞, –∫–∞–ª–æ—Ä–∏–∏, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏)
‚îú‚îÄ‚îÄ config.py          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ storage.py         # –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ JSON
‚îú‚îÄ‚îÄ states.py          # –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
‚îú‚îÄ‚îÄ utils.py           # –£—Ç–∏–ª–∏—Ç—ã (API –ø–æ–≥–æ–¥—ã –∏ –µ–¥—ã)
‚îú‚îÄ‚îÄ requirements.txt   # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ Dockerfile         # –î–ª—è –¥–µ–ø–ª–æ—è
‚îî‚îÄ‚îÄ env.example        # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

## üìä –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

–í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏–∑ –∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:
- ‚úÖ –†–∞–±–æ—Ç–∞—é—â–∏–π Telegram-–±–æ—Ç (2 –±–∞–ª–ª–∞)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è (1 –±–∞–ª–ª)
- ‚úÖ –†–∞—Å—á—ë—Ç –≤–æ–¥—ã –∏ –∫–∞–ª–æ—Ä–∏–π (0.3 –±–∞–ª–ª–∞)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API (0.2 –±–∞–ª–ª–∞)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–¥—ã, –µ–¥—ã, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ (4.5 –±–∞–ª–ª–∞)
- ‚úÖ –ú–µ—Ç–æ–¥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (1 –±–∞–ª–ª)
- ‚úÖ –î–µ–ø–ª–æ–π —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º (1 –±–∞–ª–ª)

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
- ‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (+2 –±–∞–ª–ª–∞)
- ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (+1 –±–∞–ª–ª)
- ‚úÖ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏ (+2 –±–∞–ª–ª–∞)

**–ò—Ç–æ–≥–æ: 13/13 –±–∞–ª–ª–æ–≤**

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –ù–µ –∑–∞–≥—Ä—É–∂–∞–π—Ç–µ —Ñ–∞–π–ª—ã `.env` –∏ `data.json` –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –û–Ω–∏ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.gitignore`.

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö —É—á–µ–±–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è.

## üë§ –ê–≤—Ç–æ—Ä

SergeySolovyev
